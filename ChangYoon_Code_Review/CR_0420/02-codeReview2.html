<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    class swComponent extends HTMLElement {
    constructor() {
      super();
      this.startTime = null; // 초기화
      this.countTime = null;
      this.time = 0;
      this.attachShadow({ mode: 'open' });     // 쉐도우 돔 열기
      this.shadowRoot.innerHTML = `
        <div class="stopwatch">
          <div class="time">00:00:00.00</div>               // 스톱워치 내용 00:00:00 주기
          <div class="btn1">
            <button class="btn start">Start</button>        // div 안에 버튼 3개 
            <button class="btn stop">Stop</button>
            <button class="btn reset">Reset</button>
          </div>
        </div>
      `;
      this.timeDisplay = this.shadowRoot.querySelector('.time'); // 버튼 가져오기 주르륵
      this.startBtn = this.shadowRoot.querySelector('.start'); 
      this.stopBtn = this.shadowRoot.querySelector('.stop');
      this.resetBtn = this.shadowRoot.querySelector('.reset');
      this.startBtn.addEventListener('click', this.start.bind(this)); // 이벤트들 주르륵
      this.stopBtn.addEventListener('click', this.stop.bind(this));
      this.resetBtn.addEventListener('click', this.reset.bind(this));
    }

    start() {
        if (!this.startTime) { // 타임이 0이 아니면
            this.startTime = Date.now() - this.time;  //현재시간-this.time 으로 주기
        }
        this.countTime = setInterval(() => {          // 시간마다 반복
            this.time = Date.now() - this.startTime; //this.time은 현재시간-버튼 누른 시간
            this.updateTimeDisplay();
        }, 10);
    }

    stop() {
        clearInterval(this.countTime); //멈춤
        this.countTime = null;  //초기화
        this.startTime = null;  // 스타트타임 초기화
    }
        
    reset() {               // 리셋
        this.stop();        // 멈춤
        this.time = 0;      // 타임 0으로 초기화
        this.updateTimeDisplay();
    }
        
    updateTimeDisplay() {
        console.log(this.time);
        const hours = Math.floor(this.time / (1000*60*60)).toString().padStart(2,'0'); // 시간 출력, 한자리수면 앞에 0채루기
        const minutes = Math.floor(this.time / (1000*60)).toString().padStart(2, '0'); // 분 출력, 위와동일
        const seconds = Math.floor((this.time % (1000*60)) / 1000).toString().padStart(2, '0'); // 초 출력, 위와동일
        const milliseconds = (this.time % 1000).toString().padStart(3, '0');              // 밀리초 출력, 3자리로 채우기
        this.timeDisplay.textContent = `${hours}:${minutes}:${seconds}.${milliseconds}`; // 화면 표시
    }
}

customElements.define('stopwatch-component', swComponent); // 실행
  </script>
</body>
</html>